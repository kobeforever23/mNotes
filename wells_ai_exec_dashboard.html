<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Transformation Command Center</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #eef3ef;
      --ink: #102230;
      --muted: #557082;
      --panel: #ffffff;
      --line: #d7e1de;
      --accent: #0a7b6a;
      --accent-2: #f18f01;
      --accent-3: #1f5f9a;
      --danger: #b42318;
      --warn: #b54708;
      --ok: #067647;
      --radius: 18px;
      --shadow: 0 14px 30px rgba(14, 37, 46, 0.08);
    }

    * {
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      color: var(--ink);
      font-family: "IBM Plex Sans", sans-serif;
      background:
        radial-gradient(1100px 600px at 95% -20%, rgba(10, 123, 106, 0.12), transparent 58%),
        radial-gradient(900px 500px at -10% 10%, rgba(241, 143, 1, 0.12), transparent 54%),
        var(--bg);
    }

    .shell {
      max-width: 1480px;
      margin: 0 auto;
      padding: 24px;
    }

    .hero {
      background: linear-gradient(130deg, #0f2538, #1f5f9a 62%, #178f7f);
      color: #f8fbfc;
      border-radius: 24px;
      padding: 24px 28px;
      box-shadow: 0 16px 34px rgba(15, 37, 56, 0.32);
      display: grid;
      gap: 14px;
      overflow: hidden;
      position: relative;
    }

    .hero::after {
      content: "";
      position: absolute;
      right: -50px;
      top: -40px;
      width: 220px;
      height: 220px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.02));
      filter: blur(1px);
    }

    .hero h1 {
      margin: 0;
      font-family: "Space Grotesk", sans-serif;
      letter-spacing: 0.2px;
      font-size: clamp(1.5rem, 2.4vw, 2.2rem);
    }

    .hero p {
      margin: 0;
      max-width: 960px;
      color: rgba(246, 251, 255, 0.9);
      font-size: 0.98rem;
    }

    .hero-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 4px;
    }

    .pill {
      background: rgba(255, 255, 255, 0.14);
      border: 1px solid rgba(255, 255, 255, 0.24);
      border-radius: 999px;
      padding: 6px 11px;
      font-size: 0.82rem;
      backdrop-filter: blur(2px);
    }

    .layout {
      margin-top: 20px;
      display: grid;
      grid-template-columns: 280px minmax(0, 1fr);
      gap: 18px;
    }

    .panel {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .sidebar {
      position: sticky;
      top: 18px;
      align-self: start;
      padding: 14px;
      display: grid;
      gap: 8px;
    }

    .sidebar a {
      display: block;
      text-decoration: none;
      color: var(--ink);
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 0.93rem;
      border: 1px solid transparent;
      transition: 180ms ease;
    }

    .sidebar a:hover,
    .sidebar a:focus-visible {
      border-color: #cae4de;
      background: #f2f9f7;
      color: #0a5b4f;
      outline: none;
    }

    .sidebar .subnote {
      color: var(--muted);
      font-size: 0.82rem;
      margin: 4px 0 2px;
      padding: 0 6px;
    }

    .content {
      display: grid;
      gap: 18px;
    }

    section {
      padding: 20px;
    }

    .section-head {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 10px;
      align-items: baseline;
      margin-bottom: 14px;
    }

    .section-head h2 {
      margin: 0;
      font-family: "Space Grotesk", sans-serif;
      letter-spacing: 0.1px;
      font-size: 1.22rem;
    }

    .section-head p {
      margin: 0;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 12px;
    }

    .kpi {
      border: 1px solid #d5e7e2;
      border-radius: 12px;
      padding: 12px;
      background: linear-gradient(180deg, #fbfdfd, #f4faf8);
    }

    .kpi label {
      color: var(--muted);
      font-size: 0.78rem;
      display: block;
      margin-bottom: 4px;
    }

    .kpi strong {
      font-size: 1.26rem;
      letter-spacing: 0.15px;
      font-family: "Space Grotesk", sans-serif;
    }

    .kpi small {
      color: #336963;
      display: block;
      margin-top: 2px;
      font-size: 0.78rem;
    }

    .chart-wrap {
      border: 1px solid #dce5e2;
      border-radius: 12px;
      padding: 10px;
      background: #fcfefd;
    }

    .chart-caption {
      color: var(--muted);
      font-size: 0.8rem;
      margin-top: 8px;
    }

    .control-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
    }

    .control {
      border: 1px solid #d8e3e0;
      border-radius: 12px;
      padding: 10px 12px;
      background: #fafdfc;
    }

    .control label {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      font-size: 0.86rem;
      margin-bottom: 8px;
      color: #2b4555;
    }

    input[type="number"],
    input[type="text"],
    select,
    textarea {
      width: 100%;
      border: 1px solid #c8d9d4;
      border-radius: 10px;
      padding: 8px 10px;
      font-family: inherit;
      font-size: 0.92rem;
      background: #fff;
      color: var(--ink);
    }

    input[type="range"] {
      width: 100%;
      accent-color: var(--accent);
    }

    button {
      border: 0;
      border-radius: 10px;
      padding: 9px 12px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: 150ms ease;
    }

    .btn-main {
      background: var(--accent);
      color: white;
    }

    .btn-main:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
    }

    .btn-ghost {
      background: #e8f1ef;
      color: #0d5147;
      border: 1px solid #cbe0db;
    }

    .btn-ghost:hover {
      background: #deece9;
    }

    .scenario-out {
      margin-top: 12px;
      display: grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 10px;
    }

    .metric-box {
      border: 1px solid #d8e5e2;
      background: #fbfefd;
      border-radius: 11px;
      padding: 10px;
    }

    .metric-box span {
      color: var(--muted);
      font-size: 0.78rem;
      display: block;
      margin-bottom: 3px;
    }

    .metric-box strong {
      font-size: 1.06rem;
      font-family: "Space Grotesk", sans-serif;
    }

    .scenario-note {
      grid-column: 1 / -1;
      border: 1px dashed #a6ccc4;
      border-radius: 11px;
      padding: 10px 12px;
      color: #19463f;
      background: #f3fbf8;
      font-size: 0.9rem;
    }

    .calc-grid {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }

    .calc-card {
      border: 1px solid #d7e3e0;
      border-radius: 13px;
      padding: 12px;
      background: #fbfefd;
      display: grid;
      gap: 8px;
      align-content: start;
    }

    .calc-card h3 {
      margin: 0;
      font-size: 0.98rem;
      font-family: "Space Grotesk", sans-serif;
    }

    .calc-output {
      margin-top: 6px;
      border-top: 1px dashed #c9dcda;
      padding-top: 8px;
      display: grid;
      gap: 5px;
      font-size: 0.88rem;
    }

    .calc-output strong {
      font-family: "Space Grotesk", sans-serif;
      font-size: 1rem;
    }

    .risk-layout {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
      gap: 12px;
    }

    .risk-matrix {
      display: grid;
      gap: 8px;
    }

    .risk-item {
      border: 1px solid #dae5e2;
      border-radius: 11px;
      padding: 10px;
      background: #fcfefe;
      display: grid;
      gap: 6px;
    }

    .risk-top {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: center;
      font-size: 0.9rem;
    }

    .risk-score {
      font-family: "Space Grotesk", sans-serif;
      font-size: 0.95rem;
      border-radius: 999px;
      padding: 3px 8px;
      border: 1px solid #ccd9d6;
      background: #eff5f3;
    }

    .risk-score.high {
      border-color: #e7b7b0;
      color: #901f13;
      background: #fbeae8;
    }

    .risk-score.med {
      border-color: #ecd1aa;
      color: #7c5008;
      background: #fef4e7;
    }

    .risk-score.low {
      border-color: #bfe1cc;
      color: #16683d;
      background: #edf9f1;
    }

    .risk-bar {
      width: 100%;
      height: 8px;
      border-radius: 999px;
      background: #e8efed;
      overflow: hidden;
    }

    .risk-bar > i {
      display: block;
      height: 100%;
      background: linear-gradient(90deg, #f18f01, #cf2515);
      border-radius: inherit;
    }

    .governance-box {
      border: 1px solid #dbe5e2;
      border-radius: 11px;
      padding: 10px;
      background: #fbfefd;
    }

    .checklist {
      display: grid;
      gap: 8px;
      margin-top: 8px;
    }

    .check-row {
      display: flex;
      gap: 8px;
      align-items: start;
      font-size: 0.86rem;
      color: #264656;
    }

    .check-row input {
      margin-top: 2px;
      accent-color: var(--accent);
    }

    .jurisdiction {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
      margin-bottom: 8px;
    }

    .jurisdiction label {
      font-size: 0.8rem;
      border: 1px solid #ccdbd7;
      border-radius: 999px;
      padding: 4px 8px;
      background: #f2f8f6;
      color: #24524d;
      cursor: pointer;
    }

    .obligation-list {
      margin: 0;
      padding-left: 20px;
      display: grid;
      gap: 6px;
      font-size: 0.86rem;
      color: #2e4957;
    }

    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }

    .chip {
      background: #e8f2f0;
      border: 1px solid #cddedb;
      color: #214f4a;
      font-size: 0.82rem;
      border-radius: 999px;
      padding: 5px 10px;
      cursor: pointer;
    }

    .chip.active {
      background: #0a7b6a;
      border-color: #0a7b6a;
      color: white;
    }

    .table-wrap {
      border: 1px solid #d7e4e1;
      border-radius: 12px;
      overflow-x: auto;
      background: #fcfefe;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 860px;
    }

    th, td {
      text-align: left;
      padding: 9px 10px;
      border-bottom: 1px solid #e2ece9;
      font-size: 0.86rem;
      vertical-align: top;
    }

    th {
      color: #3d5968;
      background: #f5faf8;
      font-size: 0.8rem;
      letter-spacing: 0.2px;
    }

    td .tag {
      display: inline-block;
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid #cedbd8;
      font-size: 0.75rem;
      color: #33586b;
      background: #f4f9f8;
    }

    .research-tools {
      display: grid;
      grid-template-columns: 1fr 220px;
      gap: 10px;
      margin-bottom: 10px;
    }

    .research-list {
      display: grid;
      gap: 8px;
      max-height: 460px;
      overflow: auto;
      padding-right: 2px;
    }

    .research-card {
      border: 1px solid #d7e4e1;
      border-radius: 11px;
      padding: 10px;
      background: #fcfefe;
      display: grid;
      gap: 5px;
    }

    .research-card h4 {
      margin: 0;
      font-size: 0.91rem;
    }

    .research-card p {
      margin: 0;
      font-size: 0.83rem;
      color: #355061;
    }

    .research-card a {
      color: #0f6d8f;
      text-decoration: none;
      font-size: 0.81rem;
      width: fit-content;
    }

    .research-card a:hover {
      text-decoration: underline;
    }

    .prompt-grid {
      margin-top: 10px;
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
    }

    .prompt {
      border: 1px dashed #b9d5cf;
      border-radius: 10px;
      padding: 9px;
      background: #f3fbf8;
      font-size: 0.82rem;
      color: #224941;
    }

    .board-tools {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 8px;
    }

    textarea {
      min-height: 260px;
      resize: vertical;
      line-height: 1.44;
    }

    .status {
      margin-top: 6px;
      min-height: 19px;
      color: #35626f;
      font-size: 0.82rem;
    }

    .reveal {
      opacity: 0;
      transform: translateY(20px);
      transition: 550ms cubic-bezier(0.22, 1, 0.36, 1);
    }

    .reveal.visible {
      opacity: 1;
      transform: translateY(0);
    }

    @media (max-width: 1200px) {
      .kpi-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .calc-grid {
        grid-template-columns: 1fr;
      }

      .scenario-out {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .risk-layout {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 980px) {
      .layout {
        grid-template-columns: 1fr;
      }

      .sidebar {
        position: static;
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .research-tools {
        grid-template-columns: 1fr;
      }

      .prompt-grid {
        grid-template-columns: 1fr;
      }
    }

    @media print {
      .sidebar,
      .board-tools,
      .hero-meta .pill:nth-child(n+2) {
        display: none !important;
      }

      body {
        background: white;
      }

      .panel,
      .hero {
        box-shadow: none;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <header class="hero reveal">
      <h1>AI Transformation Command Center</h1>
      <p>Executive dashboard built from the CHRO/COO transformation framework for a Wells Fargo-scale U.S. bank. It combines strategic monitoring, scenario modeling, calculators, governance controls, and research in one decision surface.</p>
      <div class="hero-meta">
        <span class="pill">Baseline workforce: 225,000</span>
        <span class="pill">Planning horizon: 0-60 months</span>
        <span class="pill" id="todayStamp"></span>
        <span class="pill">Prepared mode: Executive</span>
      </div>
    </header>

    <div class="layout">
      <aside class="sidebar panel reveal">
        <div class="subnote">Navigation</div>
        <a href="#cockpit">Executive Cockpit</a>
        <a href="#scenario-lab">Scenario Composer</a>
        <a href="#calculators">Calculator Suite</a>
        <a href="#risk-control">Governance & Risk</a>
        <a href="#peer-intel">Peer Intelligence</a>
        <a href="#research-center">Research Studio</a>
        <a href="#board-pack">Board Pack Builder</a>
      </aside>

      <main class="content">
        <section id="cockpit" class="panel reveal">
          <div class="section-head">
            <h2>Executive Cockpit</h2>
            <p>Live readout from current scenario assumptions.</p>
          </div>
          <div class="kpi-grid">
            <div class="kpi">
              <label>Baseline Headcount</label>
              <strong id="kpiBaseline">225,000</strong>
              <small>Enterprise FTE planning anchor</small>
            </div>
            <div class="kpi">
              <label>Year 5 Workforce</label>
              <strong id="kpiYear5">201,300</strong>
              <small>Projected steady-state size</small>
            </div>
            <div class="kpi">
              <label>Net Reduction</label>
              <strong id="kpiNetReduction">10.5%</strong>
              <small id="kpiDelta">23,700 positions</small>
            </div>
            <div class="kpi">
              <label>Governance Readiness</label>
              <strong id="kpiGovernance">0%</strong>
              <small>Control coverage score</small>
            </div>
          </div>
          <div class="chart-wrap">
            <svg id="trajectoryChart" viewBox="0 0 760 300" width="100%" height="300" role="img" aria-label="Headcount trajectory chart"></svg>
            <div class="chart-caption">Profiles shown: conservative (9%), base (14%), aggressive (18%), plus your current custom scenario.</div>
          </div>
        </section>

        <section id="scenario-lab" class="panel reveal">
          <div class="section-head">
            <h2>Scenario Composer</h2>
            <p>Adjust board-level assumptions to model workforce trajectory and posture.</p>
          </div>

          <div class="control-grid">
            <div class="control">
              <label><span>Scenario Profile</span></label>
              <select id="profileSelect">
                <option value="conservative">Conservative</option>
                <option value="base" selected>Base</option>
                <option value="aggressive">Aggressive</option>
              </select>
            </div>
            <div class="control">
              <label><span>Baseline Headcount</span></label>
              <input id="baselineInput" type="number" min="100000" step="1000" value="225000">
            </div>
            <div class="control">
              <label>
                <span>Year 5 Theoretical Reduction</span>
                <strong id="year5ReductionValue">14%</strong>
              </label>
              <input id="year5Reduction" type="range" min="5" max="30" step="0.5" value="14">
            </div>
            <div class="control">
              <label>
                <span>Attrition Backfill Rate</span>
                <strong id="backfillRateValue">35%</strong>
              </label>
              <input id="backfillRate" type="range" min="0" max="100" step="1" value="35">
            </div>
            <div class="control">
              <label><span>Workforce Stance</span></label>
              <select id="workforceStance">
                <option value="no_involuntary">No involuntary reductions</option>
                <option value="managed_attrition" selected>Managed attrition + targeted reductions</option>
                <option value="structural_resizing">Structural resizing</option>
              </select>
            </div>
            <div class="control">
              <label><span>Scenario Controls</span></label>
              <button id="resetScenario" class="btn-ghost" type="button">Reset to Base Profile</button>
            </div>
          </div>

          <div class="scenario-out">
            <div class="metric-box">
              <span>Year 1 Headcount</span>
              <strong id="scenarioYear1">221,300</strong>
            </div>
            <div class="metric-box">
              <span>Year 3 Headcount</span>
              <strong id="scenarioYear3">212,400</strong>
            </div>
            <div class="metric-box">
              <span>Year 5 Headcount</span>
              <strong id="scenarioYear5">201,300</strong>
            </div>
            <div class="metric-box">
              <span>Net Change by Year 5</span>
              <strong id="scenarioDelta">-23,700</strong>
            </div>
            <div class="metric-box">
              <span>Realized Reduction</span>
              <strong id="scenarioPct">10.5%</strong>
            </div>
            <div class="scenario-note" id="scenarioNarrative"></div>
          </div>
        </section>

        <section id="calculators" class="panel reveal">
          <div class="section-head">
            <h2>Calculator Suite</h2>
            <p>Finance-ready models for HR, operations, and enterprise ROI timing.</p>
          </div>

          <div class="calc-grid">
            <article class="calc-card">
              <h3>HR Run-Cost Model</h3>
              <label>Enterprise Headcount
                <input id="enterpriseHeadcount" type="number" value="225000" min="100000" step="1000">
              </label>
              <label>HR Function Size (% of enterprise)
                <input id="hrRatio" type="number" value="1.4" min="0.6" max="3" step="0.1">
              </label>
              <label>Fully Loaded HR Cost / FTE
                <input id="hrLoadedCost" type="number" value="145000" min="80000" step="5000">
              </label>
              <label>
                HR Reduction Target by Year 5
                <strong id="hrReductionTargetValue">32%</strong>
              </label>
              <input id="hrReductionTarget" type="range" min="20" max="50" value="32" step="1">
              <div class="calc-output">
                <div>Baseline HR FTE: <strong id="hrBaselineFte">3,150</strong></div>
                <div>Target HR FTE (Y5): <strong id="hrTargetFte">2,142</strong></div>
                <div>Steady-State Annual Savings: <strong id="hrAnnualSavings">$146,160,000</strong></div>
                <div>Estimated 5-Year Savings (ramped): <strong id="hrFiveYearSavings">$467,712,000</strong></div>
              </div>
            </article>

            <article class="calc-card">
              <h3>Ops Capacity Release</h3>
              <label>Annual Cases / Inquiries
                <input id="opsCases" type="number" value="9500000" min="100000" step="10000">
              </label>
              <label>Avg Handling Time (minutes)
                <input id="opsMinutes" type="number" value="19" min="2" step="1">
              </label>
              <label>
                Self-Service Deflection
                <strong id="opsDeflectionValue">28%</strong>
              </label>
              <input id="opsDeflection" type="range" min="0" max="70" value="28" step="1">
              <label>
                Agentic / Assisted Resolution Rate
                <strong id="opsAutomationValue">35%</strong>
              </label>
              <input id="opsAutomation" type="range" min="0" max="80" value="35" step="1">
              <label>Annual Hours per FTE
                <input id="opsHoursPerFte" type="number" value="1800" min="1500" step="50">
              </label>
              <div class="calc-output">
                <div>Hours Saved: <strong id="opsHoursSaved">1,249,567</strong></div>
                <div>FTE Capacity Released: <strong id="opsFteReleased">694</strong></div>
                <div>Quality Signal: <strong id="opsQualitySignal">Balanced rollout window</strong></div>
              </div>
            </article>

            <article class="calc-card">
              <h3>Transformation ROI Timing</h3>
              <label>Tech + Data Modernization ($M)
                <input id="invTech" type="number" value="180" min="0" step="5">
              </label>
              <label>Reskilling + Mobility Infra ($M)
                <input id="invReskill" type="number" value="75" min="0" step="5">
              </label>
              <label>Governance + Controls ($M)
                <input id="invGovernance" type="number" value="40" min="0" step="5">
              </label>
              <label>Transition Costs ($M)
                <input id="invTransition" type="number" value="120" min="0" step="5">
              </label>
              <label>Annual Benefits Year 1 ($M)
                <input id="benefitY1" type="number" value="95" min="0" step="5">
              </label>
              <label>Annual Benefits Year 3 ($M)
                <input id="benefitY3" type="number" value="280" min="0" step="5">
              </label>
              <label>Annual Benefits Year 5 ($M)
                <input id="benefitY5" type="number" value="430" min="0" step="5">
              </label>
              <div class="calc-output">
                <div>Total Investment: <strong id="roiTotalInvestment">$415.0M</strong></div>
                <div>Estimated Payback: <strong id="roiPayback">2.8 years</strong></div>
                <div>5-Year Net Value: <strong id="roiNet5yr">$785.0M</strong></div>
                <div>
                  Cumulative Position:
                  <div class="risk-bar" style="margin-top: 6px;"><i id="roiCumulativeBar" style="width: 68%; background: linear-gradient(90deg, #0a7b6a, #1f5f9a);"></i></div>
                </div>
              </div>
            </article>
          </div>
        </section>

        <section id="risk-control" class="panel reveal">
          <div class="section-head">
            <h2>Governance & Risk Control</h2>
            <p>High-risk AI employment and operating controls mapped to current use case and jurisdictions.</p>
          </div>

          <div class="control-grid" style="margin-bottom: 12px;">
            <div class="control">
              <label><span>AI Use Case</span></label>
              <select id="aiUseCase">
                <option value="hiring" selected>Hiring / Screening</option>
                <option value="promotion">Promotion / Performance</option>
                <option value="monitoring">Workforce Monitoring</option>
                <option value="workforce_planning">Workforce Planning</option>
              </select>
            </div>
            <div class="control">
              <label><span>Jurisdictions in scope</span></label>
              <div class="jurisdiction">
                <label><input class="jurisdictionToggle" type="checkbox" value="Federal" checked> Federal</label>
                <label><input class="jurisdictionToggle" type="checkbox" value="NYC" checked> NYC</label>
                <label><input class="jurisdictionToggle" type="checkbox" value="Illinois"> Illinois</label>
                <label><input class="jurisdictionToggle" type="checkbox" value="Colorado"> Colorado</label>
                <label><input class="jurisdictionToggle" type="checkbox" value="EU"> EU</label>
              </div>
            </div>
          </div>

          <div class="risk-layout">
            <div>
              <div class="governance-box">
                <strong style="font-family: 'Space Grotesk', sans-serif;">Required Control Actions</strong>
                <ul class="obligation-list" id="obligationList"></ul>
              </div>

              <div class="risk-matrix" id="riskMatrix" style="margin-top: 10px;"></div>
            </div>

            <div class="governance-box">
              <strong style="font-family: 'Space Grotesk', sans-serif;">Control Checklist</strong>
              <div class="checklist" id="controlChecklist"></div>
              <div style="margin-top: 10px; font-size: 0.86rem; color: #2f5062;">Governance Readiness: <strong id="governanceReadiness">0%</strong></div>
              <div class="risk-bar" style="margin-top: 6px;"><i id="governanceBar" style="width: 0%; background: linear-gradient(90deg, #f18f01, #0a7b6a);"></i></div>
            </div>
          </div>
        </section>

        <section id="peer-intel" class="panel reveal">
          <div class="section-head">
            <h2>Peer Intelligence</h2>
            <p>Externally signaled moves across major banks and fintechs.</p>
          </div>

          <div class="filter-row">
            <button class="chip active peerFilter" type="button" data-filter="all">All</button>
            <button class="chip peerFilter" type="button" data-filter="productivity">Productivity</button>
            <button class="chip peerFilter" type="button" data-filter="workforce">Workforce</button>
            <button class="chip peerFilter" type="button" data-filter="delayering">Delayering</button>
            <button class="chip peerFilter" type="button" data-filter="customer">Customer AI</button>
            <button class="chip peerFilter" type="button" data-filter="governance">Governance</button>
          </div>

          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Institution</th>
                  <th>Signal</th>
                  <th>Metric</th>
                  <th>Domain</th>
                  <th>Implication</th>
                </tr>
              </thead>
              <tbody id="peerTableBody"></tbody>
            </table>
          </div>
        </section>

        <section id="research-center" class="panel reveal">
          <div class="section-head">
            <h2>Research Studio</h2>
            <p>Searchable source map and executive research prompts.</p>
          </div>

          <div class="research-tools">
            <input id="researchSearch" type="text" placeholder="Search topic, source, metric, regulation...">
            <select id="researchTheme">
              <option value="all">All themes</option>
              <option value="regulatory">Regulatory</option>
              <option value="workforce">Workforce</option>
              <option value="productivity">Productivity</option>
              <option value="technology">Technology</option>
              <option value="operating-model">Operating Model</option>
            </select>
          </div>

          <div id="researchList" class="research-list"></div>

          <div class="prompt-grid">
            <div class="prompt">Research prompt: Compare U.S. state-by-state employment AI requirements against target operating footprint before launching hiring AI.</div>
            <div class="prompt">Research prompt: Test whether productivity gains come from workflow redesign vs tooling-only rollout by function and leader accountability model.</div>
            <div class="prompt">Research prompt: Build vendor concentration heatmap for LLM/model providers and define contingency plans under third-party risk guidance.</div>
          </div>
        </section>

        <section id="board-pack" class="panel reveal">
          <div class="section-head">
            <h2>Board Pack Builder</h2>
            <p>Generate an executive summary from current assumptions and model outputs.</p>
          </div>
          <div class="board-tools">
            <button id="generateBrief" class="btn-main" type="button">Generate Brief</button>
            <button id="copyBrief" class="btn-ghost" type="button">Copy Brief</button>
            <button id="downloadScenario" class="btn-ghost" type="button">Download Scenario JSON</button>
            <button id="printBrief" class="btn-ghost" type="button">Print Dashboard</button>
          </div>
          <textarea id="boardBrief" readonly></textarea>
          <div id="copyStatus" class="status"></div>
        </section>
      </main>
    </div>
  </div>

  <script>
    const numberFormat = new Intl.NumberFormat("en-US");
    const moneyFormat = new Intl.NumberFormat("en-US", { style: "currency", currency: "USD", maximumFractionDigits: 0 });
    const decimalFormat = new Intl.NumberFormat("en-US", { minimumFractionDigits: 1, maximumFractionDigits: 1 });
    const $ = (id) => document.getElementById(id);

    const scenarioProfiles = {
      conservative: { year5Reduction: 9, hrReduction: 25, opsDeflection: 20, opsAutomation: 26 },
      base: { year5Reduction: 14, hrReduction: 32, opsDeflection: 28, opsAutomation: 35 },
      aggressive: { year5Reduction: 18, hrReduction: 40, opsDeflection: 40, opsAutomation: 48 }
    };

    const riskItems = [
      { title: "Employment Bias / Adverse Impact", severity: 5, likelihood: 4, owner: "CHRO + Legal" },
      { title: "Model Risk and Documentation Gaps", severity: 4, likelihood: 4, owner: "Model Risk + CIO" },
      { title: "Third-Party AI Concentration", severity: 4, likelihood: 3, owner: "COO + Procurement" },
      { title: "Worker Surveillance / FCRA Exposure", severity: 4, likelihood: 3, owner: "Legal + Compliance" },
      { title: "Reputation from AI-Washing Narrative", severity: 3, likelihood: 3, owner: "CEO Office + Comms" }
    ];

    const controlItems = [
      { id: "bias_audit", label: "Bias audit and adverse impact testing on employment tools", weight: 18, checked: true },
      { id: "human_override", label: "Documented human review for high-stakes decisions", weight: 15, checked: true },
      { id: "model_inventory", label: "SR 11-7-aligned model inventory and validation workflow", weight: 14, checked: true },
      { id: "tprm", label: "Third-party due diligence and concentration contingency plan", weight: 12, checked: true },
      { id: "warn_playbook", label: "WARN/OWBPA decision workflow in workforce transitions", weight: 10, checked: false },
      { id: "worker_notice", label: "Jurisdictional notice/consent workflow (NYC/IL/CO)", weight: 10, checked: false },
      { id: "monitoring_policy", label: "Board-approved policy on AI monitoring and surveillance boundaries", weight: 11, checked: false },
      { id: "redeploy_commitment", label: "Board-approved redeployment/reskilling commitments", weight: 10, checked: false }
    ];

    const obligations = {
      hiring: {
        Federal: [
          "Run adverse impact testing on automated selection procedures and keep documented human override controls."
        ],
        NYC: [
          "Complete AEDT bias audit and provide candidate notice prior to tool use in hiring/promotion contexts."
        ],
        Illinois: [
          "Provide notice/consent and retention controls when AI video interview analysis is used."
        ],
        Colorado: [
          "Treat as a high-risk employment AI system with risk management, documentation, and disclosure controls."
        ],
        EU: [
          "Scope EU AI Act obligations for HR systems in applicable entities and operating jurisdictions."
        ]
      },
      promotion: {
        Federal: [
          "Apply disparate impact testing and maintain explainable factors for performance/promotion recommendations."
        ],
        NYC: [
          "If AEDT is used in promotions, enforce bias audit and notice obligations."
        ],
        Illinois: [
          "Ensure transparency where AI-derived indicators are used in advancement decisions."
        ],
        Colorado: [
          "Implement governance controls for high-risk HR decision support and employee-facing disclosures."
        ],
        EU: [
          "Confirm high-risk classification and implement technical documentation and human oversight obligations."
        ]
      },
      monitoring: {
        Federal: [
          "Review worker monitoring and algorithmic scoring against labor and consumer protection risks (including FCRA triggers)."
        ],
        NYC: [
          "Ensure local notice and fairness controls where automated assessments influence employment outcomes."
        ],
        Illinois: [
          "Validate employee notice where AI analysis tools process interview or performance media."
        ],
        Colorado: [
          "Deploy monitoring controls with risk management plans and remediation pathways."
        ],
        EU: [
          "Assess restrictions on intrusive monitoring and employee rights under applicable EU regimes."
        ]
      },
      workforce_planning: {
        Federal: [
          "Use analytics as decision support only; preserve accountable human decision rights and anti-discrimination testing."
        ],
        NYC: [
          "If workforce-planning tools influence employment actions, evaluate AEDT applicability."
        ],
        Illinois: [
          "Review data usage and employee transparency obligations for AI-driven workforce assessment."
        ],
        Colorado: [
          "Maintain documented risk controls for high-impact planning systems."
        ],
        EU: [
          "Establish lawful basis, transparency, and governance controls for cross-border workforce analytics."
        ]
      }
    };

    const peerData = [
      { institution: "JPMorgan", signal: "Internal LLM suite scaled across enterprise", metric: "Broad employee rollout; multiple use cases", domain: "productivity", implication: "Move from pilots to workflow operating model quickly." },
      { institution: "JPMorgan", signal: "Engineering productivity lift", metric: "~10-20% coding productivity", domain: "productivity", implication: "Hiring demand can flatten despite growing AI agenda." },
      { institution: "Bank of America", signal: "AI-enabled service and banker productivity", metric: "Erica framed as ~11k employee-equivalent work", domain: "customer", implication: "Service deflection and augmentation can materially affect labor mix." },
      { institution: "Citigroup", signal: "Developer capacity creation", metric: "~100k developer hours/week freed", domain: "productivity", implication: "Capacity capture discipline determines whether value reaches P&L." },
      { institution: "Citigroup", signal: "Structural simplification", metric: "Delayering from 13 to 8 management layers", domain: "delayering", implication: "Layer compression can be explicit strategic policy." },
      { institution: "Wells Fargo", signal: "AI-linked workforce narrative", metric: "Leadership expectation of fewer employees entering 2026", domain: "workforce", implication: "Workforce planning must be first-order, not downstream." },
      { institution: "Goldman Sachs", signal: "Firmwide assistant and restructuring posture", metric: "AI assistant rollout with constrained growth stance", domain: "workforce", implication: "AI initiatives are tied to operating model decisions, not side projects." },
      { institution: "Morgan Stanley", signal: "Wealth AI differentiation", metric: "Advisor-focused genAI rollout", domain: "operating-model", implication: "Some AI value is revenue/service quality, not only cost takeout." },
      { institution: "Klarna", signal: "Aggressive customer-service automation", metric: "Large chat share and projected profit impact", domain: "customer", implication: "Deflection gains must be balanced with quality and retention metrics." },
      { institution: "HSBC", signal: "Controlled model partnership strategy", metric: "Secure/partnered AI model approach", domain: "governance", implication: "Model hosting strategy is a board-level risk choice." }
    ];

    const researchData = [
      {
        title: "U.S. Bank Executives on AI Productivity and Jobs",
        source: "Reuters (Dec 9, 2025)",
        theme: "workforce",
        takeaway: "Large-bank leaders publicly linked AI to productivity expansion and workforce implications.",
        url: "https://www.reuters.com/business/finance/us-bank-executives-say-ai-will-boost-productivity-cut-jobs-2025-12-09/"
      },
      {
        title: "Wells Fargo Signals Fewer Employees Into 2026",
        source: "Reuters (Dec 9, 2025)",
        theme: "workforce",
        takeaway: "AI was framed as a mechanism to operate with fewer people over time.",
        url: "https://www.reuters.com/business/finance/wells-fargo-sees-more-job-cuts-going-into-2026-2025-12-09/"
      },
      {
        title: "Bank of America AI Productivity Disclosure",
        source: "Reuters (Nov 17, 2025)",
        theme: "productivity",
        takeaway: "Reported meaningful productivity signals and labor-equivalent framing from AI assistant usage.",
        url: "https://www.reuters.com/business/finance/bofa-says-ai-is-boosting-bankers-productivity-revenue-2025-11-17/"
      },
      {
        title: "Citi AI Tools Capacity Creation",
        source: "Reuters (Oct 14, 2025)",
        theme: "productivity",
        takeaway: "Developer-hours disclosure is a strong indicator of measurable capacity creation.",
        url: "https://www.reuters.com/business/citigroups-ai-usage-frees-up-100000-hours-developers-week-2025-10-14/"
      },
      {
        title: "JPMorgan Coding Assistant Productivity Lift",
        source: "Reuters (Mar 13, 2025)",
        theme: "productivity",
        takeaway: "Large engineering teams can gain significant throughput, affecting hiring and delivery cadence.",
        url: "https://www.reuters.com/technology/artificial-intelligence/jpmorgan-engineers-efficiency-jumps-much-20-using-coding-assistant-2025-03-13/"
      },
      {
        title: "Interagency Third-Party Risk Guidance",
        source: "Federal Reserve / OCC (2023)",
        theme: "regulatory",
        takeaway: "AI vendor lifecycle governance, contingency planning, and ongoing monitoring are mandatory disciplines.",
        url: "https://www.federalreserve.gov/supervisionreg/srletters/sr2304a1.pdf"
      },
      {
        title: "Model Risk Management (SR 11-7)",
        source: "Federal Reserve / OCC (2011)",
        theme: "regulatory",
        takeaway: "AI/ML systems that influence outcomes should follow model governance, validation, and monitoring controls.",
        url: "https://www.federalreserve.gov/supervisionreg/srletters/sr1107.htm"
      },
      {
        title: "EEOC Guidance on AI and Adverse Impact",
        source: "EEOC (2023)",
        theme: "regulatory",
        takeaway: "Automated selection tools remain subject to anti-discrimination standards and impact analysis expectations.",
        url: "https://www.eeoc.gov/laws/guidance/select-issues-assessing-adverse-impact-software-algorithms-and-artificial"
      },
      {
        title: "NYC Automated Employment Decision Tools",
        source: "NYC DCWP",
        theme: "regulatory",
        takeaway: "Bias audit and notice requirements apply to covered automated tools used in employment decisions.",
        url: "https://www.nyc.gov/site/dca/about/automated-employment-decision-tools.page"
      },
      {
        title: "CFPB Circular on Employment Dossiers and Scores",
        source: "CFPB Circular 2024-06",
        theme: "regulatory",
        takeaway: "Algorithmic employment scoring can trigger FCRA obligations when used in decisions.",
        url: "https://www.consumerfinance.gov/compliance/circulars/consumer-financial-protection-circular-2024-06-background-dossiers-and-algorithmic-scores-for-hiring-promotion-and-other-employment-decisions/"
      },
      {
        title: "BCBS 239 Risk Data Principles",
        source: "BIS (2013)",
        theme: "technology",
        takeaway: "Data lineage and reporting quality are foundational requirements that AI does not replace.",
        url: "https://www.bis.org/publ/bcbs239.pdf"
      },
      {
        title: "McKinsey on Extracting AI Value in Banking",
        source: "McKinsey (2024)",
        theme: "operating-model",
        takeaway: "Workflow redesign and enterprise rewiring are stronger value drivers than tool deployment alone.",
        url: "https://www.mckinsey.com/industries/financial-services/our-insights/extracting-value-from-ai-in-banking-rewiring-the-enterprise"
      }
    ];

    const scenarioState = {
      baseline: 225000,
      year1: 0,
      year3: 0,
      year5: 0,
      reductionPct: 0,
      delta: 0,
      realizedReduction: 0
    };

    const hrState = {};
    const opsState = {};
    const roiState = {};

    function stanceMultiplier(value) {
      if (value === "no_involuntary") return 0.78;
      if (value === "managed_attrition") return 0.9;
      return 1;
    }

    function formatMillions(value) {
      return `$${decimalFormat.format(value)}M`;
    }

    function updateDateStamp() {
      const dateLabel = new Date().toLocaleString("en-US", {
        weekday: "short",
        year: "numeric",
        month: "short",
        day: "numeric",
        hour: "numeric",
        minute: "2-digit"
      });
      $("todayStamp").textContent = `Updated: ${dateLabel}`;
    }

    function updateScenarioLabels() {
      $("year5ReductionValue").textContent = `${Number($("year5Reduction").value).toFixed(1)}%`;
      $("backfillRateValue").textContent = `${$("backfillRate").value}%`;
    }

    function calcScenario() {
      const baseline = Number($("baselineInput").value) || 225000;
      const year5Theoretical = Number($("year5Reduction").value);
      const backfill = Number($("backfillRate").value);
      const multiplier = stanceMultiplier($("workforceStance").value);

      const realizedReduction = Math.max(0, year5Theoretical * (1 - backfill / 100) * multiplier);
      const year1Reduction = realizedReduction * 0.2;
      const year3Reduction = realizedReduction * 0.62;
      const year1 = Math.round(baseline * (1 - year1Reduction / 100));
      const year3 = Math.round(baseline * (1 - year3Reduction / 100));
      const year5 = Math.round(baseline * (1 - realizedReduction / 100));
      const delta = baseline - year5;

      scenarioState.baseline = baseline;
      scenarioState.year1 = year1;
      scenarioState.year3 = year3;
      scenarioState.year5 = year5;
      scenarioState.delta = delta;
      scenarioState.reductionPct = delta === 0 ? 0 : (delta / baseline) * 100;
      scenarioState.realizedReduction = realizedReduction;

      $("scenarioYear1").textContent = numberFormat.format(year1);
      $("scenarioYear3").textContent = numberFormat.format(year3);
      $("scenarioYear5").textContent = numberFormat.format(year5);
      $("scenarioDelta").textContent = `-${numberFormat.format(delta)}`;
      $("scenarioPct").textContent = `${scenarioState.reductionPct.toFixed(1)}%`;

      $("kpiBaseline").textContent = numberFormat.format(baseline);
      $("kpiYear5").textContent = numberFormat.format(year5);
      $("kpiNetReduction").textContent = `${scenarioState.reductionPct.toFixed(1)}%`;
      $("kpiDelta").textContent = `${numberFormat.format(delta)} positions`;

      if (scenarioState.reductionPct < 8) {
        $("scenarioNarrative").textContent = "Conservative posture: value capture is primarily through controlled hiring moderation and selective automation. Consider whether this pace is sufficient against peer productivity disclosures.";
      } else if (scenarioState.reductionPct < 14) {
        $("scenarioNarrative").textContent = "Balanced posture: material operating leverage is captured with managed attrition and targeted reductions. Governance burden increases in promotion, hiring, and transition workflows.";
      } else {
        $("scenarioNarrative").textContent = "Aggressive posture: structural resizing and management layer compression become core to execution. Requires board-level transition commitments and robust legal controls.";
      }

      if (document.activeElement !== $("enterpriseHeadcount")) {
        $("enterpriseHeadcount").value = baseline;
      }

      calcHR();
      renderTrajectoryChart();
    }

    function profileApply(profileName) {
      const profile = scenarioProfiles[profileName];
      if (!profile) return;
      $("year5Reduction").value = profile.year5Reduction;
      $("hrReductionTarget").value = profile.hrReduction;
      $("opsDeflection").value = profile.opsDeflection;
      $("opsAutomation").value = profile.opsAutomation;
      updateScenarioLabels();
      $("hrReductionTargetValue").textContent = `${$("hrReductionTarget").value}%`;
      $("opsDeflectionValue").textContent = `${$("opsDeflection").value}%`;
      $("opsAutomationValue").textContent = `${$("opsAutomation").value}%`;
      calcScenario();
      calcHR();
      calcOps();
    }

    function seriesFromReduction(baseline, reductionPct) {
      return [
        baseline,
        baseline * (1 - (reductionPct * 0.2) / 100),
        baseline * (1 - (reductionPct * 0.62) / 100),
        baseline * (1 - reductionPct / 100)
      ];
    }

    function path(points) {
      return points.map((pt, idx) => `${idx === 0 ? "M" : "L"}${pt[0].toFixed(2)} ${pt[1].toFixed(2)}`).join(" ");
    }

    function renderTrajectoryChart() {
      const svg = $("trajectoryChart");
      const width = 760;
      const height = 300;
      const margin = { top: 20, right: 22, bottom: 36, left: 58 };
      const years = [0, 1, 3, 5];
      const baseline = scenarioState.baseline || 225000;

      const data = [
        { key: "Conservative", color: "#89b4ad", lineWidth: 2, values: seriesFromReduction(baseline, 9) },
        { key: "Base", color: "#1f5f9a", lineWidth: 2.4, values: seriesFromReduction(baseline, 14) },
        { key: "Aggressive", color: "#d97706", lineWidth: 2.6, values: seriesFromReduction(baseline, 18) },
        { key: "Current", color: "#0a7b6a", lineWidth: 3.2, values: seriesFromReduction(baseline, scenarioState.realizedReduction || 0), dash: "8 5" }
      ];

      const allValues = data.flatMap((d) => d.values);
      const maxY = Math.max(...allValues) * 1.01;
      const minY = Math.min(...allValues) * 0.985;
      const plotW = width - margin.left - margin.right;
      const plotH = height - margin.top - margin.bottom;

      const x = (year) => margin.left + (year / 5) * plotW;
      const y = (value) => margin.top + ((maxY - value) / (maxY - minY || 1)) * plotH;

      let grid = "";
      for (let i = 0; i <= 4; i++) {
        const value = minY + ((maxY - minY) * i) / 4;
        const yy = y(value);
        grid += `<line x1="${margin.left}" y1="${yy}" x2="${width - margin.right}" y2="${yy}" stroke="#e3ecea" stroke-width="1" />`;
        grid += `<text x="${margin.left - 8}" y="${yy + 4}" fill="#5f7888" font-size="10" text-anchor="end">${Math.round(value / 1000)}k</text>`;
      }

      let yearTicks = "";
      years.forEach((yr) => {
        const xx = x(yr);
        yearTicks += `<line x1="${xx}" y1="${height - margin.bottom}" x2="${xx}" y2="${height - margin.bottom + 6}" stroke="#9db2bc" />`;
        yearTicks += `<text x="${xx}" y="${height - 10}" fill="#4d6878" font-size="11" text-anchor="middle">Y${yr}</text>`;
      });

      const lines = data.map((dataset) => {
        const points = years.map((yr, idx) => [x(yr), y(dataset.values[idx])]);
        const marker = points.map((p) => `<circle cx="${p[0]}" cy="${p[1]}" r="2.9" fill="${dataset.color}" />`).join("");
        return `<path d="${path(points)}" fill="none" stroke="${dataset.color}" stroke-width="${dataset.lineWidth}" ${dataset.dash ? `stroke-dasharray="${dataset.dash}"` : ""} />
          ${marker}`;
      }).join("");

      const legend = data.map((d, idx) =>
        `<g transform="translate(${margin.left + idx * 160}, ${margin.top + 12})">
          <line x1="0" y1="0" x2="20" y2="0" stroke="${d.color}" stroke-width="${d.lineWidth}" ${d.dash ? `stroke-dasharray="${d.dash}"` : ""} />
          <text x="26" y="4" font-size="11" fill="#305266">${d.key}</text>
        </g>`
      ).join("");

      svg.innerHTML = `
        <rect x="0" y="0" width="${width}" height="${height}" fill="#fcfefe"></rect>
        ${grid}
        <line x1="${margin.left}" y1="${height - margin.bottom}" x2="${width - margin.right}" y2="${height - margin.bottom}" stroke="#9db2bc" />
        ${yearTicks}
        ${lines}
        ${legend}
      `;
    }

    function calcHR() {
      const enterprise = Number($("enterpriseHeadcount").value) || scenarioState.baseline || 225000;
      const ratio = Number($("hrRatio").value) || 1.4;
      const loadedCost = Number($("hrLoadedCost").value) || 145000;
      const reduction = Number($("hrReductionTarget").value) || 32;

      $("hrReductionTargetValue").textContent = `${reduction}%`;

      const baselineFte = Math.round((enterprise * ratio) / 100);
      const targetFte = Math.round(baselineFte * (1 - reduction / 100));
      const deltaFte = baselineFte - targetFte;
      const annualSavings = deltaFte * loadedCost;
      const fiveYearSavings = annualSavings * 3.2;

      hrState.baselineFte = baselineFte;
      hrState.targetFte = targetFte;
      hrState.annualSavings = annualSavings;
      hrState.fiveYearSavings = fiveYearSavings;

      $("hrBaselineFte").textContent = numberFormat.format(baselineFte);
      $("hrTargetFte").textContent = numberFormat.format(targetFte);
      $("hrAnnualSavings").textContent = moneyFormat.format(annualSavings);
      $("hrFiveYearSavings").textContent = moneyFormat.format(fiveYearSavings);
    }

    function calcOps() {
      const cases = Number($("opsCases").value) || 0;
      const minutes = Number($("opsMinutes").value) || 0;
      const deflection = Number($("opsDeflection").value) || 0;
      const automation = Number($("opsAutomation").value) || 0;
      const hoursPerFte = Number($("opsHoursPerFte").value) || 1800;

      $("opsDeflectionValue").textContent = `${deflection}%`;
      $("opsAutomationValue").textContent = `${automation}%`;

      const baseHours = (cases * minutes) / 60;
      const deflectionHours = baseHours * (deflection / 100);
      const assistedHours = baseHours * (1 - deflection / 100) * (automation / 100) * 0.35;
      const totalHoursSaved = Math.round(deflectionHours + assistedHours);
      const fteReleased = Math.round(totalHoursSaved / hoursPerFte);

      let qualitySignal = "Balanced rollout window";
      if (deflection > 45 || automation > 60) {
        qualitySignal = "Aggressive: track NPS, first-contact resolution, rework";
      } else if (deflection < 18) {
        qualitySignal = "Conservative: value capture likely below peer pace";
      }

      opsState.hoursSaved = totalHoursSaved;
      opsState.fteReleased = fteReleased;
      opsState.qualitySignal = qualitySignal;

      $("opsHoursSaved").textContent = numberFormat.format(totalHoursSaved);
      $("opsFteReleased").textContent = numberFormat.format(fteReleased);
      $("opsQualitySignal").textContent = qualitySignal;
    }

    function calcROI() {
      const invTech = Number($("invTech").value) || 0;
      const invReskill = Number($("invReskill").value) || 0;
      const invGov = Number($("invGovernance").value) || 0;
      const invTransition = Number($("invTransition").value) || 0;
      const y1 = Number($("benefitY1").value) || 0;
      const y3 = Number($("benefitY3").value) || 0;
      const y5 = Number($("benefitY5").value) || 0;

      const totalInvestment = invTech + invReskill + invGov + invTransition;
      const annualBenefits = [y1, (y1 + y3) / 2, y3, (y3 + y5) / 2, y5];
      const annualCosts = [totalInvestment * 0.6, totalInvestment * 0.4, 0, 0, 0];

      let cumulative = 0;
      let paybackYear = null;
      let previous = 0;

      annualBenefits.forEach((benefit, i) => {
        previous = cumulative;
        cumulative += benefit - annualCosts[i];
        if (paybackYear === null && cumulative >= 0) {
          if (previous < 0) {
            const crossed = (0 - previous) / (cumulative - previous);
            paybackYear = (i + crossed + 1).toFixed(1);
          } else {
            paybackYear = (i + 1).toFixed(1);
          }
        }
      });

      const totalBenefits = annualBenefits.reduce((a, b) => a + b, 0);
      const netValue = totalBenefits - totalInvestment;
      const progress = Math.max(0, Math.min(100, ((cumulative + totalInvestment) / (totalBenefits + totalInvestment || 1)) * 100));

      roiState.totalInvestment = totalInvestment;
      roiState.netValue = netValue;
      roiState.paybackYear = paybackYear || ">5.0";

      $("roiTotalInvestment").textContent = formatMillions(totalInvestment);
      $("roiPayback").textContent = paybackYear ? `${paybackYear} years` : ">5 years";
      $("roiNet5yr").textContent = formatMillions(netValue);
      $("roiCumulativeBar").style.width = `${progress}%`;
    }

    function renderRiskMatrix() {
      const html = riskItems
        .map((risk) => {
          const score = risk.severity * risk.likelihood;
          const cls = score >= 16 ? "high" : score >= 9 ? "med" : "low";
          const pct = Math.min(100, score * 4);
          return `
            <article class="risk-item">
              <div class="risk-top">
                <strong>${risk.title}</strong>
                <span class="risk-score ${cls}">${score}/25</span>
              </div>
              <div class="risk-bar"><i style="width:${pct}%"></i></div>
              <div style="font-size:0.8rem; color:#4a6473;">Owner: ${risk.owner}</div>
            </article>
          `;
        })
        .join("");
      $("riskMatrix").innerHTML = html;
    }

    function renderChecklist() {
      $("controlChecklist").innerHTML = controlItems
        .map((item) => `
          <label class="check-row">
            <input class="controlToggle" type="checkbox" data-weight="${item.weight}" ${item.checked ? "checked" : ""}>
            <span>${item.label}</span>
          </label>
        `)
        .join("");

      document.querySelectorAll(".controlToggle").forEach((input, idx) => {
        input.addEventListener("change", () => {
          controlItems[idx].checked = input.checked;
          updateGovernanceScore();
        });
      });
    }

    function updateGovernanceScore() {
      const total = controlItems.reduce((sum, item) => sum + item.weight, 0);
      const achieved = controlItems.reduce((sum, item) => sum + (item.checked ? item.weight : 0), 0);
      const pct = Math.round((achieved / total) * 100);
      $("governanceReadiness").textContent = `${pct}%`;
      $("governanceBar").style.width = `${pct}%`;
      $("kpiGovernance").textContent = `${pct}%`;
    }

    function updateObligations() {
      const useCase = $("aiUseCase").value;
      const selected = Array.from(document.querySelectorAll(".jurisdictionToggle:checked")).map((el) => el.value);
      const rows = [];
      selected.forEach((jur) => {
        (obligations[useCase][jur] || []).forEach((item) => rows.push(`<li><strong>${jur}:</strong> ${item}</li>`));
      });
      $("obligationList").innerHTML = rows.length ? rows.join("") : "<li>Select at least one jurisdiction.</li>";
    }

    function renderPeers(filter = "all") {
      const body = $("peerTableBody");
      const filtered = filter === "all" ? peerData : peerData.filter((row) => row.domain === filter);
      body.innerHTML = filtered
        .map((row) => `
          <tr>
            <td><strong>${row.institution}</strong></td>
            <td>${row.signal}</td>
            <td>${row.metric}</td>
            <td><span class="tag">${row.domain}</span></td>
            <td>${row.implication}</td>
          </tr>
        `)
        .join("");
    }

    function renderResearch() {
      const query = $("researchSearch").value.trim().toLowerCase();
      const theme = $("researchTheme").value;
      const filtered = researchData.filter((item) => {
        const themeMatch = theme === "all" || item.theme === theme;
        if (!themeMatch) return false;
        if (!query) return true;
        const hay = `${item.title} ${item.source} ${item.takeaway} ${item.theme}`.toLowerCase();
        return hay.includes(query);
      });

      $("researchList").innerHTML = filtered.length
        ? filtered
            .map((item) => `
              <article class="research-card">
                <h4>${item.title}</h4>
                <p><strong>${item.source}</strong>  <span class="tag">${item.theme}</span></p>
                <p>${item.takeaway}</p>
                <a href="${item.url}" target="_blank" rel="noopener noreferrer">Open source</a>
              </article>
            `)
            .join("")
        : `<article class="research-card"><h4>No matching sources</h4><p>Try a broader keyword or switch theme filters.</p></article>`;
    }

    function generateBoardBrief() {
      const stanceLabel = $("workforceStance").options[$("workforceStance").selectedIndex].text;
      const topRisks = riskItems
        .map((r) => ({ ...r, score: r.severity * r.likelihood }))
        .sort((a, b) => b.score - a.score)
        .slice(0, 3)
        .map((r) => `- ${r.title} (${r.score}/25, owner: ${r.owner})`)
        .join("\n");

      const brief = [
        "AI TRANSFORMATION BOARD BRIEF",
        "",
        `Date: ${new Date().toLocaleDateString("en-US")}`,
        "",
        "1) Workforce Trajectory",
        `- Baseline enterprise headcount: ${numberFormat.format(scenarioState.baseline)}.`,
        `- Projected year 1 / year 3 / year 5 headcount: ${numberFormat.format(scenarioState.year1)} / ${numberFormat.format(scenarioState.year3)} / ${numberFormat.format(scenarioState.year5)}.`,
        `- Net year 5 reduction: ${scenarioState.reductionPct.toFixed(1)}% (${numberFormat.format(scenarioState.delta)} positions).`,
        `- Workforce stance selected: ${stanceLabel}.`,
        "",
        "2) HR Transformation Economics",
        `- Baseline HR FTE: ${numberFormat.format(hrState.baselineFte || 0)}; target HR FTE by year 5: ${numberFormat.format(hrState.targetFte || 0)}.`,
        `- Annual steady-state HR savings: ${moneyFormat.format(hrState.annualSavings || 0)}.`,
        `- Estimated 5-year HR savings (ramped): ${moneyFormat.format(hrState.fiveYearSavings || 0)}.`,
        "",
        "3) Operations Capacity",
        `- Estimated annual hours saved: ${numberFormat.format(opsState.hoursSaved || 0)}.`,
        `- FTE capacity released: ${numberFormat.format(opsState.fteReleased || 0)}.`,
        `- Quality posture: ${opsState.qualitySignal || "N/A"}.`,
        "",
        "4) Investment and ROI",
        `- Total investment: ${formatMillions(roiState.totalInvestment || 0)}.`,
        `- Estimated payback: ${roiState.paybackYear ? `${roiState.paybackYear} years` : ">5 years"}.`,
        `- 5-year net value: ${formatMillions(roiState.netValue || 0)}.`,
        "",
        "5) Top Risks",
        topRisks,
        "",
        "6) Governance Readiness",
        `- Control checklist coverage: ${$("governanceReadiness").textContent}.`,
        "- Next board action: lock policy boundaries for AI-decided vs AI-recommended employment actions and enforce model/third-party governance gates prior to scale."
      ].join("\n");

      $("boardBrief").value = brief;
    }

    function copyBrief() {
      const text = $("boardBrief").value;
      if (!text) {
        $("copyStatus").textContent = "Generate the brief first.";
        return;
      }
      navigator.clipboard.writeText(text)
        .then(() => {
          $("copyStatus").textContent = "Board brief copied to clipboard.";
        })
        .catch(() => {
          $("copyStatus").textContent = "Clipboard copy blocked by browser policy.";
        });
    }

    function downloadScenario() {
      const payload = {
        createdAt: new Date().toISOString(),
        scenario: scenarioState,
        hrModel: hrState,
        opsModel: opsState,
        roiModel: roiState,
        governanceReadiness: $("governanceReadiness").textContent,
        controls: controlItems
      };

      const blob = new Blob([JSON.stringify(payload, null, 2)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "ai_transformation_scenario.json";
      document.body.appendChild(link);
      link.click();
      link.remove();
      URL.revokeObjectURL(link.href);
    }

    function bindInputs() {
      updateScenarioLabels();
      $("profileSelect").addEventListener("change", (e) => profileApply(e.target.value));
      $("baselineInput").addEventListener("input", calcScenario);
      $("year5Reduction").addEventListener("input", () => {
        updateScenarioLabels();
        calcScenario();
      });
      $("backfillRate").addEventListener("input", () => {
        updateScenarioLabels();
        calcScenario();
      });
      $("workforceStance").addEventListener("change", calcScenario);
      $("resetScenario").addEventListener("click", () => {
        $("profileSelect").value = "base";
        $("baselineInput").value = 225000;
        $("backfillRate").value = 35;
        $("workforceStance").value = "managed_attrition";
        profileApply("base");
      });

      ["enterpriseHeadcount", "hrRatio", "hrLoadedCost"].forEach((id) => {
        $(id).addEventListener("input", calcHR);
      });
      $("hrReductionTarget").addEventListener("input", calcHR);

      ["opsCases", "opsMinutes", "opsHoursPerFte"].forEach((id) => {
        $(id).addEventListener("input", calcOps);
      });
      $("opsDeflection").addEventListener("input", calcOps);
      $("opsAutomation").addEventListener("input", calcOps);

      ["invTech", "invReskill", "invGovernance", "invTransition", "benefitY1", "benefitY3", "benefitY5"].forEach((id) => {
        $(id).addEventListener("input", calcROI);
      });

      $("aiUseCase").addEventListener("change", updateObligations);
      document.querySelectorAll(".jurisdictionToggle").forEach((toggle) => toggle.addEventListener("change", updateObligations));

      document.querySelectorAll(".peerFilter").forEach((btn) => {
        btn.addEventListener("click", () => {
          document.querySelectorAll(".peerFilter").forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          renderPeers(btn.dataset.filter);
        });
      });

      $("researchSearch").addEventListener("input", renderResearch);
      $("researchTheme").addEventListener("change", renderResearch);

      $("generateBrief").addEventListener("click", generateBoardBrief);
      $("copyBrief").addEventListener("click", copyBrief);
      $("downloadScenario").addEventListener("click", downloadScenario);
      $("printBrief").addEventListener("click", () => window.print());
    }

    function setupReveal() {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("visible");
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1 });
      document.querySelectorAll(".reveal").forEach((el) => observer.observe(el));
    }

    function init() {
      updateDateStamp();
      renderRiskMatrix();
      renderChecklist();
      updateGovernanceScore();
      updateObligations();
      renderPeers("all");
      renderResearch();
      bindInputs();
      profileApply("base");
      calcOps();
      calcROI();
      generateBoardBrief();
      setupReveal();
    }

    init();
  </script>
</body>
</html>
